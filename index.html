<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Overlog: Overwatch Match Logging</title>
    <link rel="stylesheet" href="assets/css/styles.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <h1>Overlog</h1>
                <div class="session-info">
                    <span id="sessionMatches">Session: 0 matches</span>
                    <span id="sessionWR">Win Rate: --</span>
                </div>
            </div>
            <button id="newSessionBtn" class="new-session-btn" title="Start New Session">
                <img src="assets/icons/arrow-path.svg" alt="New Session" class="new-session-icon">
            </button>
            <button id="themeToggleBtn" class="theme-toggle-btn" title="Toggle Theme">
                <img src="assets/icons/sun.svg" alt="Light Mode" class="theme-icon theme-icon-sun">
                <img src="assets/icons/moon.svg" alt="Dark Mode" class="theme-icon theme-icon-moon">
            </button>
            <button id="settingsBtn" class="settings-btn" title="Settings">
                <img src="assets/icons/settings.svg" alt="Settings" class="settings-icon">
            </button>
        </header>

        <main>
            <!-- Warning Banners -->
            <div id="storageWarningBanner" class="warning-banner" style="display: none;">
                <div class="banner-content">
                    <strong>‚ö†Ô∏è Storage Warning:</strong> You're using over 80% of browser storage.
                    Consider exporting and clearing old data.
                </div>
                <button id="closeStorageWarning" class="banner-close">&times;</button>
            </div>

            <div id="exportReminderBanner" class="reminder-banner" style="display: none;">
                <div class="banner-content">
                    <strong>üíæ Backup Reminder:</strong> You have 100+ matches. Back up your data!
                    <button id="quickExportBtn" class="quick-export-btn">Export Now</button>
                </div>
                <button id="closeExportReminder" class="banner-close">&times;</button>
            </div>

            <!-- Quick Log Section -->
            <section class="quick-log">
                <h2>Log Match</h2>

                <!-- Match Preview (styled like match history) -->
                <div id="matchPreview" class="match-preview">
                    <div class="match-info">
                        <span id="previewResult" class="match-result">---</span>
                        <div class="match-type-with-edit">
                            <span id="previewType" class="match-type">Select match type...</span>
                            <button id="matchTypeEdit" class="match-type-edit-btn" title="Edit match type (T)" aria-label="Edit match type">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                </svg>
                            </button>
                        </div>
                        <span id="previewHeroes" class="match-heroes" style="display: none;"></span>
                    </div>
                </div>

                <!-- Match Type Selection (Collapsible) -->
                <div class="match-type-wrapper">
                    <div id="matchTypeSection" class="match-type-section" style="display: none;">
                        <div class="match-type-buttons">
                            <!-- Match type buttons will be dynamically generated -->
                        </div>
                    </div>
                </div>

                <!-- Recent Heroes -->
                <div id="recentHeroesContainer" class="recent-heroes-container" style="display: none;">
                    <div class="recent-heroes-header">Recent Heroes:</div>
                    <div id="recentHeroesButtons" class="recent-heroes-buttons">
                        <!-- Recent hero buttons will be dynamically generated -->
                    </div>
                </div>

                <!-- Hero Selection (Collapsible) -->
                <div class="hero-section-wrapper">
                    <button id="heroSectionToggle" class="hero-toggle-btn">
                        <span class="key-hint">E</span>
                        Add Heroes ‚ñº
                    </button>

                    <div id="heroSelection" class="hero-selection" style="display: none;">
                        <div id="heroButtons" class="hero-container">
                            <!-- Hero buttons will be dynamically generated -->
                        </div>
                    </div>
                </div>

                <div class="result-buttons">
                    <button class="result-btn win" data-result="win" data-key="w">
                        Win
                    </button>
                    <button class="result-btn loss" data-result="loss" data-key="l">
                        Loss
                    </button>
                    <button class="result-btn draw" data-result="draw" data-key="d">
                        Draw
                    </button>
                </div>

                <button id="saveBtn" class="save-btn" disabled>
                    Save Match
                </button>
            </section>

            <!-- Stats Section -->
            <section class="stats">
                <div class="stats-header">
                    <h2>Quick Stats</h2>
                    <div class="stats-toggle">
                        <button id="statsToggleAllTime" class="stats-toggle-btn active">All Time</button>
                        <button id="statsToggleSession" class="stats-toggle-btn">This Session</button>
                    </div>
                </div>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="totalMatches">0</div>
                        <div class="stat-label">Total Matches</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="totalWins">0</div>
                        <div class="stat-label">Wins</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="totalLosses">0</div>
                        <div class="stat-label">Losses</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="overallWR">--%</div>
                        <div class="stat-label">Win Rate</div>
                    </div>
                </div>
            </section>

            <!-- Match History Section -->
            <section class="recent-matches">
                <div class="stats-header">
                    <h2>Match History</h2>
                    <div class="stats-toggle">
                        <button id="matchHistoryToggleAllTime" class="stats-toggle-btn active">All Time</button>
                        <button id="matchHistoryToggleSession" class="stats-toggle-btn">This Session</button>
                    </div>
                </div>
                <div id="matchList" class="match-list">
                    <p class="empty-state">No matches logged yet. Start logging!</p>
                </div>
                <div id="paginationControls" class="pagination-controls" style="display: none;">
                    <button id="prevPageBtn" class="pagination-btn" disabled>‚Üê Previous</button>
                    <span id="pageInfo" class="page-info">Page 1 of 1</span>
                    <button id="nextPageBtn" class="pagination-btn" disabled>Next ‚Üí</button>
                </div>
            </section>
        </main>

        <!-- Settings Modal -->
        <div id="settingsModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Settings</h2>
                    <button id="closeSettingsBtn" class="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <!-- Log Match Settings Section -->
                    <div class="settings-section">
                        <h3 class="settings-section-title">Log Match Settings</h3>
                        <div class="settings-group">
                            <label class="setting-label">
                                <span class="setting-name">Auto-collapse Match Type Section</span>
                                <input type="checkbox" id="settingAutoCollapseMatchType" class="setting-checkbox">
                            </label>
                            <p class="setting-description">Automatically collapse match type section after selecting a complete match type or saving a match</p>
                        </div>
                        <div class="settings-group">
                            <label class="setting-label">
                                <span class="setting-name">Show Match Saved Notifications</span>
                                <input type="checkbox" id="settingShowMatchSavedNotification" class="setting-checkbox">
                            </label>
                            <p class="setting-description">Show a notification when a match is saved</p>
                        </div>
                        <div class="settings-group">
                            <label class="setting-label">
                                <span class="setting-name">Show Draw Button</span>
                                <input type="checkbox" id="settingShowDrawButton" class="setting-checkbox">
                            </label>
                            <p class="setting-description">Show the draw button (disable if draws are not possible in your game mode)</p>
                        </div>
                    </div>

                    <!-- Hero Settings Section -->
                    <div class="settings-section">
                        <h3 class="settings-section-title">Hero Settings</h3>
                        <div class="settings-group">
                            <label class="setting-label">
                                <span class="setting-name">Show Heroes</span>
                                <input type="checkbox" id="settingShowHeroes" class="setting-checkbox">
                            </label>
                            <p class="setting-description">Show hero selection sections (Recent Heroes and Add Heroes)</p>
                        </div>
                        <div class="settings-group">
                            <label class="setting-label">
                                <span class="setting-name">Remember Hero Selection</span>
                                <input type="checkbox" id="settingRememberHeroSelection" class="setting-checkbox">
                            </label>
                            <p class="setting-description">Keep heroes selected across matches instead of clearing after each save</p>
                        </div>
                        <div class="settings-group">
                            <label class="setting-label">
                                <span class="setting-name">Recent Heroes Count</span>
                                <input type="range" id="settingRecentHeroesCount" class="setting-slider" min="0" max="8" step="1">
                                <span id="recentHeroesCountValue" class="setting-value">4</span>
                            </label>
                            <p class="setting-description">How many heroes to show in the Recent Heroes list (set to 0 to disable)</p>
                        </div>
                        <div class="settings-group">
                            <label class="setting-label">
                                <span class="setting-name">Auto-collapse Hero List</span>
                                <input type="checkbox" id="settingAutoCollapseHero" class="setting-checkbox">
                            </label>
                            <p class="setting-description">Automatically collapse hero list after saving a match</p>
                        </div>
                        <div class="settings-group">
                            <label class="setting-label">
                                <span class="setting-name">Always Show Full Hero List</span>
                                <input type="checkbox" id="settingAlwaysShowAllHeroes" class="setting-checkbox">
                            </label>
                            <p class="setting-description">Keep the full hero list always expanded (hides toggle button)</p>
                        </div>
                        <div class="settings-group">
                            <label class="setting-label">
                                <span class="setting-name">Show Hero Portraits</span>
                                <input type="checkbox" id="settingShowHeroPortraits" class="setting-checkbox">
                            </label>
                            <p class="setting-description">Display portraits on hero buttons</p>
                        </div>
                    </div>

                    <!-- Stadium Settings Section -->
                    <div class="settings-section">
                        <h3 class="settings-section-title">Stadium Settings</h3>
                        <div class="settings-group">
                            <label class="setting-label">
                                <span class="setting-name">Limit Stadium Hero Selection</span>
                                <input type="checkbox" id="settingLimitStadiumHeroSelection" class="setting-checkbox">
                            </label>
                            <p class="setting-description">Only allow selecting 1 hero at a time in Stadium game modes</p>
                        </div>
                        <div class="settings-group">
                            <label class="setting-label">
                                <span class="setting-name">Disable Non-Stadium Heroes</span>
                                <select id="settingDisableNonStadiumHeroes" class="setting-select">
                                    <option value="none">Allow All Heroes</option>
                                    <option value="dim">Dim Unavailable Heroes</option>
                                    <option value="hide">Hide Unavailable Heroes</option>
                                </select>
                            </label>
                            <p class="setting-description">Control how non-Stadium heroes appear in Stadium game modes</p>
                        </div>
                    </div>

                    <!-- Session Settings Section -->
                    <div class="settings-section">
                        <h3 class="settings-section-title">Session Settings</h3>
                        <div class="settings-group">
                            <label class="setting-label">
                                <span class="setting-name">Auto-Reset Session</span>
                                <select id="settingSessionAutoReset" class="setting-select">
                                    <option value="manual">Manual Only</option>
                                    <option value="daily">Daily (at midnight)</option>
                                    <option value="onlaunch">On App Launch</option>
                                </select>
                            </label>
                            <p class="setting-description">Control when sessions automatically reset</p>
                        </div>
                        <div class="settings-group">
                            <label class="setting-label">
                                <span class="setting-name">Show Session Reset Notifications</span>
                                <input type="checkbox" id="settingShowSessionNotification" class="setting-checkbox">
                            </label>
                            <p class="setting-description">Show a notification when starting a new session</p>
                        </div>
                    </div>

                    <!-- UI Settings Section -->
                    <div class="settings-section">
                        <h3 class="settings-section-title">UI Settings</h3>
                        <div class="settings-group">
                            <label class="setting-label">
                                <span class="setting-name">Theme</span>
                                <select id="settingTheme" class="setting-select">
                                    <option value="auto">Auto (System)</option>
                                    <option value="dark">Dark</option>
                                    <option value="light">Light</option>
                                </select>
                            </label>
                        </div>
                        <div class="settings-group">
                            <label class="setting-label">
                                <span class="setting-name">Matches Per Page</span>
                                <select id="settingMatchesPerPage" class="setting-select">
                                    <option value="5">5</option>
                                    <option value="10">10</option>
                                    <option value="25">25</option>
                                    <option value="50">50</option>
                                    <option value="all">All</option>
                                </select>
                            </label>
                            <p class="setting-description">Number of matches to display per page in Match History</p>
                        </div>
                        <div class="settings-group">
                            <label class="setting-label">
                                <span class="setting-name">Use Overwatch-Style Text</span>
                                <input type="checkbox" id="settingUseOwStyleText" class="setting-checkbox">
                            </label>
                            <p class="setting-description">Display "Victory/Defeat/Draw" instead of "Win/Loss/Draw"</p>
                        </div>
                    </div>

                    <!-- Keyboard Shortcuts Section -->
                    <div class="settings-section">
                        <h3 class="settings-section-title">Keyboard Shortcuts</h3>
                        <div class="settings-group">
                            <label class="setting-label">
                                <span class="setting-name">Enable All Keyboard Shortcuts</span>
                                <input type="checkbox" id="settingKeyboardShortcutsEnabled" class="setting-checkbox">
                            </label>
                        </div>
                        <div id="keyboardShortcutsSub" class="settings-subsection">
                            <div class="settings-group">
                                <label class="setting-label">
                                    <span class="setting-name">WASD Navigation</span>
                                    <input type="checkbox" id="settingWasdEnabled" class="setting-checkbox">
                                </label>
                            </div>
                            <div class="settings-group">
                                <label class="setting-label">
                                    <span class="setting-name">Number Keys (Match Types)</span>
                                    <input type="checkbox" id="settingNumberKeysEnabled" class="setting-checkbox">
                                </label>
                            </div>
                            <div class="settings-group">
                                <label class="setting-label">
                                    <span class="setting-name">Hotkeys (T, E, C, Space, Ctrl+Z)</span>
                                    <input type="checkbox" id="settingHotkeysEnabled" class="setting-checkbox">
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Data Management Section -->
                    <div class="settings-section">
                        <h3 class="settings-section-title">Data Management</h3>
                        <div class="settings-group">
                            <div class="storage-info">
                                <div id="storageIndicatorModal" class="storage-indicator-modal">Local Storage: Calculating...</div>
                            </div>
                        </div>
                        <div class="settings-group">
                            <div class="data-buttons">
                                <button id="importBtnModal" class="data-btn import-btn">Import Data</button>
                                <button id="exportBtnModal" class="data-btn export-btn">Export CSV</button>
                                <button id="exportJsonBtnModal" class="data-btn export-json-btn">Export JSON</button>
                                <button id="clearBtnModal" class="data-btn clear-btn">Clear All Data</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="saveSettingsBtn" class="save-settings-btn">Save Settings</button>
                    <button id="resetSettingsBtn" class="reset-settings-btn">Reset to Defaults</button>
                </div>
            </div>
        </div>

        <!-- Changelog Modal -->
        <div id="changelogModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h2><a href="https://github.com/NewbGoob/overlog/blob/main/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="modal-title-link">Changelog<img src="assets/icons/external-link.svg" alt="External link" class="external-link-icon"></a></h2>
                    <button id="closeChangelogBtn" class="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <div id="changelogContent" class="changelog-text">Loading changelog...</div>
                </div>
            </div>
        </div>

        <footer>
            <div class="footer-content">
                <div class="keyboard-hints">
                    Navigate: WASD | Select: Spacebar | Clear Heroes: C | Undo: Ctrl+Z
                </div>
                <div class="version-info">
                    <a href="https://github.com/NewbGoob/overlog" target="_blank" rel="noopener noreferrer" id="appVersion">Version 1.1.0 (local)</a>
                    <button id="changelogBtn" class="changelog-btn" title="View Changelog">
                        <img src="assets/icons/info.svg" alt="Changelog" class="changelog-icon">
                    </button>
                </div>
            </div>
        </footer>
    </div>

    <!-- Toast Notification Container -->
    <div id="toastContainer" class="toast-container"></div>

    <script type="module" src="js/app.js"></script>
</body>
</html>
